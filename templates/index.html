<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Smart Search</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #f4f4f9; display: flex; justify-content: center; padding-top: 50px; }
        .search-container { width: 400px; }
        #search-box { width: 100%; padding: 12px; font-size: 18px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
        #results { border: 1px solid #ddd; background-color: white; border-radius: 8px; margin-top: 4px; max-height: 300px; overflow-y: auto; }
        .suggestion-item { padding: 12px; cursor: pointer; border-bottom: 1px solid #eee; }
        .suggestion-item:last-child { border-bottom: none; }
        .suggestion-item:hover { background-color: #f0f0f0; }
        #correction { color: #007bff; font-style: italic; margin-top: 8px; padding: 5px; }
    </style>
</head>
<body>
    <div class="search-container">
        <h1>Smart Search</h1>
        <input type="text" id="search-box" placeholder="Start typing..." autocomplete="off">
        <div id="correction"></div>
        <div id="results"></div>
    </div>

    <script>
        const searchBox = document.getElementById('search-box');
        const resultsDiv = document.getElementById('results');
        const correctionDiv = document.getElementById('correction');

        const onKeyUp = async (event) => {
            const query = searchBox.value;

            if (query.length === 0) {
                resultsDiv.innerHTML = '';
                correctionDiv.innerHTML = '';
                return;
            }

            try {
                // Fetch suggestions from our backend API
                const response = await fetch(`/search/suggest?q=${query}`);
                const data = await response.json();

                // Display suggestions
                resultsDiv.innerHTML = ''; // Clear old suggestions
                data.suggestions.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.textContent = item;
                    div.onclick = () => {
                        searchBox.value = item;
                        resultsDiv.innerHTML = '';
                        correctionDiv.innerHTML = '';
                        searchBox.focus();
                    };
                    resultsDiv.appendChild(div);
                });

            } catch (error) {
                console.error("Error fetching suggestions:", error);
            }
        };
        
        searchBox.addEventListener('keyup', onKeyUp);
    </script>
</body>
</html>